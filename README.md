# Donations
If you feel this project would be useful you are most welcome to buy me a coffee! https://ko-fi.com/A325GAE

#Browser compatibility

As this is a pure dev tool, I only support Chrome due to it having the features I need. Other browsers can be supported if 
it becomes too big a pain point.

# test-recorder
This is an ambitious project that aims to record integration tests for any web application. It also provides assertions to changes in your DOM structure.

I am currently focused on getting the tests compatible with nightwish and Ember cli.

This project records the ways you interact with your application, and then generates the code to playback these actions inside an acceptance test runner. 
The idea is to save you time writing these tests by hand.
 
You should only add the TestRecorder.js script to your app when your app behaves as
expected (happy flow) as then you will have the tests generated for this. You can then take these tests and modify them to your specific needs.

#Current UI interactions that are recorded for acceptance tests:

* Button clicks
* Text input 
* Changes in DOM additions/removals

#Notes

The test recorder mode is specified by the user in the script tag with the data-framework attribute and then is read 
using `document.currentScript.dataset`. This works in Chrome, Edge and FF. If IE support is needed I'll have to add some
extra functionality.

If an element doesn't have an id then an exlusive dom path selector will be generated to click on this button in a test, ie
```js
click("html>body>div>div:eq(0)>button");
andThen(function () {
 equal(find("#foo").length, 0, "foo removed AFTER user [INSERT REASON]");
});
```

If you don't want an element to be recorded, and any of its children add this class to it `doNotRecord`

##Nightwatch tests

I have an example app inside /tests. First you need to build the test project by running `npm i` and `webpack` inside /tests, then you 
can open tests/build/ in the browser to see the app running with the test recorder UI. This has some basic UI that as you
interact with, will generate output integration tests.

Once you have the tests generated you can past the code into the actual test file: I've made a sample one called index.test.js

This uses the basicConf.js to run a single file ('test-recorder-spec.js'), you can paste the generated test code into there

You need to start webdriver:
`npm run webdriver`

then run protractor with :
`npm run vanilla-test`

# Using the test-recorder in your apps

`<script src="node_modules/test-recorder/test-recorder.js"></script>
<script type="text/javascript">
  var testRecorder = new TestRecorder.TestRecorder()
</script>
`

# Ember (WIP)

To use this, simply include this line of code someone in your ember-cli, I recommend in your `app.js`:

```js
import main from 'ember-cli-test-recorder/main';// jshint ignore:line
```
Note: we use jshint ignore:line as we don't actually do anything with the main object, it sets everything up by itself

## Roadmap
* Record any changes to location (routes, html5 etc)
* Allow selects to be automated
* Allow more complex click actions like the steps to click on inputs like select2 to be recorded
* Ignore clicks on ember elements with no effect
* Create codes for key-presses 
* Get mutations to work with async effects more accurately with performance api
* create tests for changes of lengths in lists
* Generate cucumber specs

##TIPS

Avoid making multiple button clicks (or other interactions that cause asynchronous) updates until DOM has 
finished updating. This will allow code generated by the mutations observer to be placed in the in the
generated code. 


